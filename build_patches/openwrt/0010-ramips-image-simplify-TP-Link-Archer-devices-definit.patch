From 71119a9ea2eeb56c1c981f10b89d0351d6799636 Mon Sep 17 00:00:00 2001
From: Piotr Dymacz <pepe2k@gmail.com>
Date: Fri, 23 Jun 2017 23:20:53 +0200
Subject: [PATCH 3/4] ramips: image: simplify TP-Link Archer devices
 definitions
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Signed-off-by: Piotr Dymacz <pepe2k@gmail.com>
[Rebased on 97ebdf9]
Signed-off-by: Fabian Bl√§se <fabian@blaese.de>
---
 target/linux/ramips/image/mt7620.mk | 21 ++++++++++-----------
 1 file changed, 10 insertions(+), 11 deletions(-)

diff --git a/target/linux/ramips/image/mt7620.mk b/target/linux/ramips/image/mt7620.mk
index bb79acb894..dd75f5a504 100644
--- a/target/linux/ramips/image/mt7620.mk
+++ b/target/linux/ramips/image/mt7620.mk
@@ -29,39 +29,38 @@ define Build/zyimage
 	$(STAGING_DIR_HOST)/bin/zyimage $(1) $@
 endef
 
-define Device/ArcherC20i
-  DTS := ArcherC20i
-  SUPPORTED_DEVICES := c20i
-  TPLINK_BOARD_ID := ArcherC20i
+define Device/Archer
   KERNEL := $(KERNEL_DTB)
   KERNEL_INITRAMFS := $(KERNEL_DTB) | tplink-v2-header
   IMAGE/factory.bin := tplink-v2-image
   IMAGE/sysupgrade.bin := tplink-v2-image -s | append-metadata
+endef
+
+define Device/ArcherC20i
+  $(Device/Archer)
+  DTS := ArcherC20i
+  SUPPORTED_DEVICES := c20i
+  TPLINK_BOARD_ID := ArcherC20i
   IMAGES += factory.bin
   DEVICE_TITLE := TP-Link ArcherC20i
 endef
 TARGET_DEVICES += ArcherC20i
 
 define Device/ArcherC50
+  $(Device/Archer)
   DTS := ArcherC50
   SUPPORTED_DEVICES := c50
   TPLINK_BOARD_ID := ArcherC50
-  KERNEL := $(KERNEL_DTB)
-  KERNEL_INITRAMFS := $(KERNEL_DTB) | tplink-v2-header
-  IMAGE/factory.bin := tplink-v2-image
-  IMAGE/sysupgrade.bin := tplink-v2-image -s | append-metadata
   IMAGES += factory.bin
   DEVICE_TITLE := TP-Link ArcherC50
 endef
 TARGET_DEVICES += ArcherC50
 
 define Device/ArcherMR200
+  $(Device/Archer)
   DTS := ArcherMR200
   SUPPORTED_DEVICES := mr200
   TPLINK_BOARD_ID := ArcherMR200
-  KERNEL := $(KERNEL_DTB)
-  KERNEL_INITRAMFS := $(KERNEL_DTB) | tplink-v2-header
-  IMAGE/sysupgrade.bin := tplink-v2-image -s | append-metadata
   DEVICE_PACKAGES := kmod-usb2 kmod-usb-net kmod-usb-net-rndis kmod-usb-serial kmod-usb-serial-option adb
   DEVICE_TITLE := TP-Link ArcherMR200
 endef
-- 
2.11.0 (Apple Git-81)

